<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>

<head>
    <title>Simulacija voznje automobila</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>

        body{
            background: green;
        }
        *{
                box-sizing: border-box;
            }
            .container{
                width: 100%;
                margin: 0 auto;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }
            .roud{
                height: 200px;
               
                position: relative;
                background: #222 url('img/line.png') repeat-x center
            }
            #car{
                width: 5%;
                height: 45px;
                position: absolute;
                bottom: 20px;
                left: 0%;
                background-size: contain;
                background-position: center;
                background-repeat: no-repeat;
                transition: 0.5s linear;
            }
            .light{
                width: 6px;
                height: 6px;
                position: absolute;
                right: 5px;
                margin-top:-3px;
                border-radius: 50%;
            }
            #light1{
                top:9px;
            }
            #light2{
                bottom: 9px;
            }
            #fuelBar{
                position: absolute;
                top:0;
                left: 0;
                width: 100%;
                height: 3px;
                background: white;
                display: none;
            }
            #currentFuelState{
                width: 100%;
                height: 100%;
                background: red;
            }
            .error{
                color:red;
            }
            .form-group{
                display: inline-block;
            }
            button{
                border:1px solid #000;
                border-radius:0;
                padding: 5px 10px;
                font-size: 16px;
                background: #cccccc;
            }
            .form-control{
                width: 250px;
                height: 30px;
                border:1px solid #000;
                margin-bottom: 10px;
                margin-top: 10px;
            }
            
            #prepreka{
                width: 50px;
                height: 50px;
                position: absolute;
                bottom: 5px;
                left: 50%;
                background: #fff;
            }
            
            @keyframes migavac {
                50% {background-color: transparent;}
                100% {background-color: 'yellow';}
            }
            
            .migavac{
                animation: migavac 5 0.3s linear;
            }

            .yellow{
                background: yellow;
            }
        </style>


    </style>
</head>

<body>
    <div class="container">

        <div class="form-group">
            <select id="car-store" class="form-control" name="car-store">
                <option value="">Izaberi model</option>
                <option value="img/mercedes.png">Mercedes</option>
                <option value="img/bmw.png">BMW</option>
                <option value="img/ford.jpg">Ford</option>
                <option value="img/fiat.png">Fiat</option>
            </select>
            <p class="error" id="car-error"></p>
        </div>

        <div class="form-group">
            <input type="text" class="form-control" id="potrosnja" value="" placeholder="Potrosnja na 100">
            <p class="error" id="potrosnja-error"></p>
        </div>
        <div class="form-group">
            <input type="text" class="form-control" id="color" value="" placeholder="Boja kola">
            <p class="error" id="color-error"></p>
        </div>
        <div class="form-group">
            <input type="text" class="form-control" id="doorNumber" value="" placeholder="Broj vrata">
            <p class="error" id="door-error"></p>
        </div>
        <button id="izaberiAuto">Izaberi auto</button>

        <div class="roud">
            <div id="prepreka">

            </div>
            <div id="car">
                <div class="light" id="light1"></div>
                <div class="light" id="light2"></div>
                <div id="fuelBar">
                    <div id="currentFuelState"></div>
                </div>
            </div>
        </div>

        <hr>

        <button id="buyCar">Kupi auto</button>
        <button id="startCar">Upali auto</button>
        <button id="go">Kreni</button>
        <button id="stopMove">Zaustavi</button>
        <button id="pretekni">Pretekni</button>
        <button id="vsust">Vrati se u svoju traku</button>
        <button id="promeniBrzinu">Promeni brzinu</button>
        <button id="stopCar">Ugasi auto</button>
        <button id="rikverc">Rikverc</button>
        <button id="dopuniGorivo">Dopuni gorivo</button>




    </div>



    <script>
        var fuelInterval;
        var fuelGas = 100;
        var position = 0;
        var speed = 1;
        var stop;
        var isBought = false;

        var car = {
            'brand': 'img/mercedes.png',
            'fuel': 'disel',
            'color': 'white',
            'potrosnja': 7,
            'brojVrata': 5,
            'upaliAuto': function () {
                if(isBought){
                    document.getElementById('light1').className = 'light yellow';
                    document.getElementById('light2').className = 'light yellow';
                    fuelInterval = setInterval(function () {
                    car.emptyTank();
                }, 1000);
                }
            },
            'emptyTank': function () {
                if (fuelGas > 0) {
                    fuelGas = fuelGas - this.potrosnja / 10;
                    document.getElementById('currentFuelState').style.width = fuelGas + '%';
                } else {
                    clearInterval(fuelInterval);
                    clearInterval(stop);
                    this.ugasiAuto();
                    tankFuels();
                }
            },
            'ugasiAuto': function(){
                document.getElementById('light1').className = ('');
                document.getElementById('light2').className = ('');
                clearInterval(fuelInterval);
                clearInterval(stop);
               
            },
            'move': function (){
               if(isBought){
                stop = setInterval(moveCar, 200);
               }
            },
            'stopCar': function(){
                clearInterval(stop);
            },
            'pretekni':function(){
                if(isBought){
                    document.getElementById('light1').className = 'light yellow migavac';
                    document.getElementById('light2').className = 'light yellow';
                    setTimeout(function(){
                    document.getElementById('car').style.bottom = '120px';
                },1000)
                }
             
            },
            'vartiSeTraku': function(){
                if(isBought){
                    document.getElementById('light1').className = 'light yellow';
                    document.getElementById('light2').className = 'light yellow migavac';
                    setTimeout(function(){
                    document.getElementById('car').style.bottom = '20px';
                },1000)
                }
            },
            'promeniBrzinu': function(){
                if(speed < 5){
                    speed ++;
                }
            },
            'reverse': function (){
                speed = -1;
            }

        };

        document.getElementById('izaberiAuto').addEventListener('click', function () {
            var error = 0;
            var brand = document.getElementById('car-store').value;
            var brandError = '';
            var potrsnjaError = '';
            var colorError = '';
            var doorNumberError = '';

            if (brand.length == 0) {
                error++;
                brandError += 'Molim izaberite model auta';
                document.getElementById('car-error').innerText = brandError;
            } else {
                document.getElementById('car-error').innerText = '';
            }

            var potrosnja = document.getElementById('potrosnja').value;
            potrosnja = potrosnja.trim();

            if (potrosnja.length == 0 || (isNaN(potrosnja))) {
                error++;
                potrsnjaError += 'Molim unesite iznos potrosnje u brojevima';
                document.getElementById('potrosnja-error').innerText = potrsnjaError;
            } else {
                document.getElementById('potrosnja-error').innerText = '';
            }

            potrosnja = parseInt(potrosnja);

            var color = document.getElementById('color').value;
            color = color.trim();

            if (color.length === 0) {
                error++;
                colorError += 'Molim unesite zeljenu boju';
                document.getElementById('color-error').innerText = colorError;
            } else {
                document.getElementById('color-error').innerText = '';
            }

            var doors = document.getElementById('doorNumber').value;
            doors = doors.trim();

            if (doors.length === 0 || (isNaN(doors))) {
                error++;
                doorNumberError += 'Molim unesite broj vrata';
                document.getElementById('door-error').innerText = doorNumberError;
            } else {
                document.getElementById('door-error').innerText = '';
            }

            doors = parseInt(doors);

            if (error === 0) {
                car.brand = brand;
                car.potrosnja = potrosnja;
                car.color = color;
                car.brojVrata = doors;
                document.getElementById('car-store').value = '';
                document.getElementById('potrosnja').value = '';
                document.getElementById('color').value = '';
                document.getElementById('doorNumber').value = '';
            }
        });

        document.getElementById('buyCar').addEventListener('click', function () {
            document.getElementById('car').style.backgroundImage = 'url("' + car.brand + '")';
            document.getElementById('fuelBar').style.display = 'block';
            isBought = true;
        });

        document.getElementById('startCar').addEventListener('click', car.upaliAuto);
        document.querySelector('#stopCar').addEventListener('click', car.ugasiAuto);

         function moveCar(){
            document.getElementById('car').style.left = position + '%';
            position = position + speed;
        };

        document.querySelector('#go').addEventListener('click', car.move);
        document.querySelector('#stopMove').addEventListener('click', car.stopCar);


        document.getElementById('pretekni').addEventListener('click', car.pretekni);
        document.getElementById('vsust').addEventListener('click', car.vartiSeTraku);
        document.getElementById('promeniBrzinu').addEventListener('click', car.promeniBrzinu);
        document.getElementById('rikverc').addEventListener('click', car.reverse);

        function tankFuels(){
            if(isBought){
                var refill = prompt('Dopuni gorivo');
            if(isNaN(refill) || refill < 1){
              alert('molimo unesite koliko zelite da dopunite goriva');
              refill = prompt('Dopuni gorivo');
            }
            refill = parseInt(refill);
            if(refill < fuelGas){
                alert('Vas auto ima dovoljno goriva');
                return;
            }
            if(refill > 0 && refill < 101){
                fuelGas = refill;
                document.getElementById('currentFuelState').style.width = fuelGas + '%';
            }else{
                fuelGas = 100;
                document.getElementById('currentFuelState').style.width = fuelGas + '%';
            }
            } 
        }

        document.getElementById('dopuniGorivo').addEventListener('click', tankFuels);

    </script>
</body>

</html>